<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.Purna Gamage">

<title>Quiz-1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="quiz-1_files/libs/clipboard/clipboard.min.js"></script>
<script src="quiz-1_files/libs/quarto-html/quarto.js"></script>
<script src="quiz-1_files/libs/quarto-html/popper.min.js"></script>
<script src="quiz-1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="quiz-1_files/libs/quarto-html/anchor.min.js"></script>
<link href="quiz-1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="quiz-1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="quiz-1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="quiz-1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="quiz-1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Quiz-1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.Purna Gamage </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p><code>Submission</code>: Submit completed document to Canvas</p>
<section id="problem" class="level2">
<h2 class="anchored" data-anchor-id="problem">Problem:</h2>
<p><code>Please read this case study and answer the following questions.</code></p>
<p>Apple introduced iPhone 14 and iPhone 14 Plus last week, featuring two sizes — 6.1 inches and 6.7 inches — in a sophisticated design with impressive camera upgrades featuring a new dual-camera system and groundbreaking new safety capabilities; including Crash Detection, a smartphone industry-first safety service with Emergency SOS via satellite, and the best battery life on iPhone. (~ <a href="https://www.apple.com/newsroom/2022/09/apple-introduces-iphone-14-and-iphone-14-plus/">Apple.com</a> )</p>
<p>( <em>This part is fictitious</em>. )</p>
<p>Assume Apple Inc.&nbsp;is researching for a new feature for next year’s iPhone upgrade and you are one of the Data Scientists working in this research team. Your team wants to survey people in the most populous states in the US; California, Texas, Florida and New York. Suppose Your team has decided to have a big event outdoors for this research purpose, randomly picking people and asking them whether they like the new feature or not based on whether the people you picked currently uses an iPhone, uses a different phone and don’t want to switch phones ever or currently using another phone but hoping to switch to an iPhone in the future.</p>
<p>In New York; From those people you randomly picked, there were 340 people who are currently using an iPhone, 185 people using a different phone and don’t want to switch phones ever and 232 people are currently using another phone but hoping to switch to an iPhone in the future.</p>
<p>Of those who are currently using an iPhone, 80% like the new feature. From those who are currently using a different phone and don’t want to switch phones ever, 52% liked the new feature.From those who are currently using another phone but hoping to switch to an iPhone in the future, 48% liked the new feature.</p>
<ol type="1">
<li>Notations.
<ol type="a">
<li>Use capital letters to denote different events in this question.</li>
<li>Specify all probabilities mentioned in the problem using conditional probability notations and general probability notations.</li>
</ol></li>
</ol>
<p><span class="math inline">\(I\)</span> = No of People using an iphone = 340</p>
<p><span class="math inline">\(B\)</span> = people not using an iphone and do not want to switch to an iPhone in the future = 185</p>
<p><span class="math inline">\(C\)</span> = people not using an iphone and want to switch to an iphone = 232</p>
<p><span class="math inline">\(L\)</span> = : The event that a person likes the new feature.</p>
<p>Conditional probability notations:</p>
<p><span class="math inline">\(P(L | I)\)</span> = Probability of liking the new feature given that the person currently uses an iPhone = 0.80</p>
<p><span class="math inline">\(P(L | B)\)</span> = Probability of liking the new feature given that the person uses a different phone and doesn’t want to switch = 0.52</p>
<p><span class="math inline">\(P(L | C)\)</span> = Probability of liking the new feature given that the person uses another phone but hopes to switch to an iPhone in the future = 0.48</p>
<p><span class="math inline">\(P(I) = \frac{340}{340+185+232}= 0.44914\)</span></p>
<p><span class="math inline">\(P(B) = \frac{185}{340+185+232}= 0.24438\)</span></p>
<p><span class="math inline">\(P(C) = \frac{232}{340+185+232}= 0.30647\)</span></p>
<ol type="1">
<li>You can see that these probabilities are only for the survey conducted in New York. But you need to easily find the probabilities for any given state. Therefore, Write a function that will find the probability that if a person liked the feature then they are currently using an iPhone. (hint: this can be done by using the sample statistics provided above, combined with random number generation to create a representative random sample)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Declaring as a function</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="cf">function</span>(samplesize, proba, probb, probc, condp1, condp2, condp3)   {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    PI <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">size=</span>samplesize, <span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(proba,probb,probc))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, samplesize)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    test[PI<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">'Yes'</span>), <span class="at">size=</span><span class="fu">sum</span>(PI<span class="sc">==</span><span class="dv">1</span>), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>condp1,condp1))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    test[PI<span class="sc">==</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">'Yes'</span>), <span class="at">size=</span><span class="fu">sum</span>(PI<span class="sc">==</span><span class="dv">2</span>), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>condp2,condp2))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    test[PI<span class="sc">==</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">'Yes'</span>), <span class="at">size=</span><span class="fu">sum</span>(PI<span class="sc">==</span><span class="dv">3</span>), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>condp3,condp3))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(PI[test<span class="sc">==</span><span class="st">'Yes'</span>]<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Using the function you wrote above and using the New York data; find the probability that if a person liked the feature then they are currently using an iPhone.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Declaring variable names</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    I <span class="ot">&lt;-</span> <span class="fl">0.449</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    notI <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>I</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="fl">0.24438</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    notB <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>B</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    C <span class="ot">&lt;-</span> <span class="fl">0.30647</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    notC <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>C</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    PLI <span class="ot">&lt;-</span> <span class="fl">0.80</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    notPLI <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>PLI</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    prob1 <span class="ot">&lt;-</span> <span class="fu">c</span>(notI,I,notB,B,notC,C,notPLI,PLI)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    condp2 <span class="ot">&lt;-</span> <span class="fl">0.52</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    notcondp2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>condp2</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    condp3 <span class="ot">&lt;-</span> <span class="fl">0.48</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    notcondp3 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>condp3</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    prob1[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.551 0.449</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>prob1[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.75562 0.24438</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#Calculate probability for New York sample  </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">x</span>(<span class="at">samplesize =</span> <span class="dv">767</span>, <span class="at">proba =</span> I, <span class="at">probb =</span> B, <span class="at">probc =</span> C, <span class="at">condp1 =</span> PLI, <span class="at">condp2 =</span> condp2, <span class="at">condp3 =</span> condp3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5873984</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Write a function to Calculate the probability directly without using a simulation, use that function to compute the probability and compare your answer to part 3.</li>
</ol>
<p>calculating <span class="math inline">\(P(A | L)\)</span> using the formula:</p>
<p><span class="math inline">\(P(A | L) = \frac{P(A \cap L)}{P(L)} = \frac{\left(\frac{340}{757}\right) \cdot 0.80}{\left(\frac{340}{757}\right) \cdot 0.80 + \left(\frac{185}{757}\right) \cdot 0.52 + \left(\frac{232}{757}\right) \cdot 0.48}\)</span> = <span class="math inline">\(0.565\)</span></p>
<p>#Function to calculate the probability:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>    calculate_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(total, P_A, P_B, P_C, PLI, PLB, PLC) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the probability of liking the new feature (P(L))</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  P_L <span class="ot">&lt;-</span> (P_A <span class="sc">*</span> PLI) <span class="sc">+</span> (P_B <span class="sc">*</span> PLB) <span class="sc">+</span> (P_C <span class="sc">*</span> PLC)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the probability of using an iPhone and liking the new feature (P(A ∩ L))</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  P_A_and_L <span class="ot">&lt;-</span> P_A <span class="sc">*</span> PLI</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the conditional probability P(A | L)</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  P_A_given_L <span class="ot">&lt;-</span> P_A_and_L <span class="sc">/</span> P_L</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(P_A_given_L)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Declaring variables</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="dv">757</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  P_A <span class="ot">&lt;-</span> <span class="dv">340</span> <span class="sc">/</span> total</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  P_B <span class="ot">&lt;-</span> <span class="dv">185</span> <span class="sc">/</span> total</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  P_C <span class="ot">&lt;-</span> <span class="dv">232</span> <span class="sc">/</span> total</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  PLI <span class="ot">&lt;-</span> <span class="fl">0.80</span>  <span class="co"># Probability of liking the new feature given using an iPhone</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  PLB <span class="ot">&lt;-</span> <span class="fl">0.52</span>  <span class="co"># Probability of liking the new feature given using a different phone and not wanting to switch</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  PLC <span class="ot">&lt;-</span> <span class="fl">0.48</span>  <span class="co"># Probability of liking the new feature given using another phone but hoping to switch to an iPhone</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">calculate_prob</span>(total,<span class="at">P_A =</span> P_A,<span class="at">P_B =</span> P_B,<span class="at">P_C =</span> P_C,<span class="at">PLI =</span> PLI,PLB,PLC))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5671866</code></pre>
</div>
</div>
<p>You can calculate this expression to find the probability that if a person liked the new feature, they are currently using an iPhone.</p>
<ol type="1">
<li>Now use Monte Carlo simulation and compare your answer to the probability found in part 4. Here, write a function that can calculate the probability in part 3(the probability that if a person liked the phone then they are currently using an iPhone) for many different number of iterations (as in Monte Carlo simulation).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Monte Carlo simulation for New York</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>compute_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(runtimes){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  same_day <span class="ot">&lt;-</span> <span class="fu">replicate</span>(runtimes,<span class="fu">x</span>(<span class="at">samplesize =</span> <span class="dv">767</span>, <span class="at">proba =</span> I, <span class="at">probb =</span> B, <span class="at">probc =</span> C, <span class="at">condp1 =</span> PLI, <span class="at">condp2 =</span> condp2, <span class="at">condp3 =</span> condp3))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(same_day)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">150</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n, compute_prob)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(n, prob) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(n, prob), <span class="at">col =</span> <span class="st">"yellow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="quiz-1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol type="1">
<li>What would be a rough minimum “large enough” number of iterations that you need to get a good probability. Use the New York Data to answer this question. (Hint: You can use a graph to answer this question).</li>
</ol>
<p>A: Large enough would be a rough minimum of 150 simulations. by looking at the graph, it converges out to From the simulation above, we can see that approximately 150 simulations are enough 1. Assuming you do this survey again in California, Find the probability that this person is currently using an iPhone given that they like the feature.</p>
<pre><code>a. Use your function from part 5 and the function you wrote in part 2 to find the above probability.</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sampling for California</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    cali <span class="ot">&lt;-</span> <span class="cf">function</span>(samplesize, proba, probb, probc, condp1, condp2, condp3)   {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    PI <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">size=</span>samplesize, <span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(proba,probb,probc))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, samplesize)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    test[PI<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">'Yes'</span>), <span class="at">size=</span><span class="fu">sum</span>(PI<span class="sc">==</span><span class="dv">1</span>), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>condp1,condp1))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    test[PI<span class="sc">==</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">'Yes'</span>), <span class="at">size=</span><span class="fu">sum</span>(PI<span class="sc">==</span><span class="dv">2</span>), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>condp2,condp2))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    test[PI<span class="sc">==</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">'Yes'</span>), <span class="at">size=</span><span class="fu">sum</span>(PI<span class="sc">==</span><span class="dv">3</span>), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>condp3,condp3))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(PI[test<span class="sc">==</span><span class="st">'Yes'</span>]<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decalaring Variables</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    sS <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="dv">610</span>,<span class="dv">580</span>,<span class="dv">330</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    dF <span class="ot">&lt;-</span> <span class="dv">580</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    dI <span class="ot">&lt;-</span> <span class="dv">330</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    I <span class="ot">&lt;-</span> <span class="dv">610</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    PI <span class="ot">&lt;-</span> I<span class="sc">/</span>sS</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    PdF <span class="ot">&lt;-</span> dF<span class="sc">/</span>sS</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    PdI <span class="ot">&lt;-</span> dI<span class="sc">/</span>sS</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    condprob1 <span class="ot">&lt;-</span> <span class="fl">0.92</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    condprob2 <span class="ot">&lt;-</span> <span class="fl">0.48</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    condprob3 <span class="ot">&lt;-</span> <span class="fl">0.67</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">cali</span>(<span class="at">samplesize =</span> sS, <span class="at">proba =</span> PI, <span class="at">probb =</span> PdF, <span class="at">probc =</span> PdI, <span class="at">condp1 =</span> condprob1, <span class="at">condp2 =</span> condprob2, <span class="at">condp3 =</span> condprob3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5247148</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Monte Carlo Simulation</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>compute_probcal <span class="ot">&lt;-</span> <span class="cf">function</span>(runtimes){</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  same_day <span class="ot">&lt;-</span> <span class="fu">replicate</span>(runtimes,<span class="fu">cali</span>(<span class="at">samplesize =</span> sS, <span class="at">proba =</span> PI, <span class="at">probb =</span> PdF, <span class="at">probc =</span> PdI, <span class="at">condp1 =</span> condprob1, <span class="at">condp2 =</span> condprob2, <span class="at">condp3 =</span> condprob3))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(same_day)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>prob1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n, compute_probcal)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(prob1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5292151</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(n, prob1) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(n, prob1), <span class="at">col =</span> <span class="st">"gold"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quiz-1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<pre><code>b. Use the function you wrote in part 4 to calculate the above probability without using a simulation.</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">calculate_prob</span>(sS,<span class="at">P_A =</span> PI,<span class="at">P_B =</span> PdF,<span class="at">P_C =</span> PdI,<span class="at">PLI =</span> condprob1,<span class="at">PLB =</span> condprob2,<span class="at">PLC =</span> condprob3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5290846</code></pre>
</div>
</div>
<pre><code>c. Compare these probabilities you got from the simulation with the probability you calculate by hand(Q7: part a and b). What can you conclude?

A: Both probabilities are almost the same, where as the monte carlo simulations are not as accurate as the calculated probabilities.</code></pre>
<p><em>Data:</em> From those people you randomly picked, there were 610 people who are currently using an iPhone, 580 people using a different phone and don’t want to switch phones ever and 330 people are currently using another phone but hoping to switch to an iPhone in the future.</p>
<p>Of those who are currently using an iPhone, 92% like the new feature. From those who are currently using a different phone and don’t want to switch phones ever, 48% liked the new feature.From those who are currently using another phone but hoping to switch to an iPhone in the future, 67% liked the new feature.</p>
<ol type="1">
<li><p>What can you say about using Monte Carlo simulation for this problem?</p>
<p>A: Monte Carlo simulation offers a flexible and effective approach to address this problem. we obtain an estimated value for <span class="math inline">\(P(A∣L)\)</span>. This estimate represents the probability that if a person likes the new feature, they are currently using an iPhone.</p></li>
<li><p>Based on the data from these 2 states, as the Data Scientist in this research team, what would be your final (non-technical) conclusion?</p>
<p>A: This data suggests a positive response of the new feature among Iphone users and those with different phones who do not intend to switch.</p>
<p>Also, people in New York are likely to switch to an iPhone in the future compared to California.</p></li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>